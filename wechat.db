CREATE TABLE `wechat`.`wx_group` (
  `id` INT NOT NULL COMMENT '主键',
  `name` VARCHAR(45) NULL COMMENT '组名称',
  `count` INT NULL COMMENT '组内人数',
  `nickname` VARCHAR(255) NULL COMMENT '别名，用于跑定时，将固定条件的人跑入这个组中',
  PRIMARY KEY (`id`)  COMMENT '');

CREATE TABLE `wechat`.`wx_user` (
  `id` INT NOT NULL AUTO_INCREMENT COMMENT '',
  `subscribe` INT NULL COMMENT '用户是否订阅该公众号标识，值为0时，代表此用户没有关注该公众号，拉取不到其余信息。',
  `openid` VARCHAR(255) NULL COMMENT '用户的标识，对当前公众号唯一',
  `nickname` VARCHAR(255) NULL COMMENT '用户的昵称',
  `sex` INT NULL COMMENT '用户的性别，值为1时是男性，值为2时是女性，值为0时是未知',
  `language` VARCHAR(255) NULL COMMENT '用户的语言，简体中文为zh_CN',
  `city` VARCHAR(255) NULL COMMENT '用户所在的城市',
  `province` VARCHAR(255) NULL COMMENT '用户所在的省份',
  `country` VARCHAR(255) NULL COMMENT '用户所在的国家',
  `headimgurl` VARCHAR(512) NULL COMMENT '用户头像，最后一个数值代表正方形头像大小（有0、46、64、96、132数值可选，0代表640*640正方形头像），用户没有头像时该项为空。若用户更换头像，原有头像URL将失效。',
  `subscribe_time` INT NULL COMMENT '用户关注时间，为时间戳。如果用户曾多次关注，则取最后关注时间',
  `unionid` VARCHAR(255) NULL COMMENT '只有在用户将公众号绑定到微信开放平台帐号后，才会出现该字段。',
  `remark` VARCHAR(255) NULL COMMENT '公众号运营者对粉丝的备注，公众号运营者可在微信公众平台用户管理界面对粉丝添加备注',
  `groupid` INT NULL COMMENT '用户所在的分组ID',
  PRIMARY KEY (`id`)  COMMENT '');

  ALTER TABLE `wechat`.`wx_user`
  CHANGE COLUMN `nickname` `nickname` VARCHAR(255) NOT NULL DEFAULT 'wepiao' COMMENT '用户的昵称' ,
  CHANGE COLUMN `city` `city` VARCHAR(255) NOT NULL DEFAULT '无' COMMENT '用户所在的城市' ,
  CHANGE COLUMN `province` `province` VARCHAR(255) NOT NULL DEFAULT '无' COMMENT '用户所在的省份' ,
  CHANGE COLUMN `country` `country` VARCHAR(255) NOT NULL DEFAULT '无' COMMENT '用户所在的国家' ,
  CHANGE COLUMN `groupid` `groupid` INT(11) NOT NULL DEFAULT 9999 COMMENT '用户所在的分组ID' ,
  ADD INDEX `index_nickname` (`nickname` ASC)  COMMENT '',
  ADD INDEX `index_city` (`city` ASC)  COMMENT '',
  ADD INDEX `index_province` (`province` ASC)  COMMENT '',
  ADD INDEX `index_country` (`country` ASC)  COMMENT '',
  ADD INDEX `index_groupid` (`groupid` ASC)  COMMENT '';

CREATE TABLE `wechat`.`wx_mass_msg` (
  `id` INT NOT NULL AUTO_INCREMENT COMMENT '主键，唯一标示',
  `thumb_media_id` VARCHAR(255) NULL COMMENT '首页缩略图media_id，通过上传图片给微信服务器获取，后续用作上传图文消息的column',
  `author` VARCHAR(45) NULL COMMENT '作者，显示在正文页，可为空，不能超过8个字',
  `title` VARCHAR(100) NULL COMMENT '标题，必填项，不能超过64字',
  `content` BLOB NULL COMMENT '正文内容',
  `content_source_url` VARCHAR(255) NULL COMMENT '正文‘阅读全文’链接的url，选填',
  `digest` VARCHAR(255) NULL COMMENT '描述，选填，只有当文本消息只有一条cover内容时展示',
  `show_cover_pic` INT NULL COMMENT '是否将封面展示在正文中，1为展示，0为不展示',
  `cover_pic_url` VARCHAR(255) NULL COMMENT '封面图片的url，调用微信接口获取',
  `add_time` DATETIME NULL COMMENT '此条记录的创建时间，只要插入了id就算创建',
  `last_update_time` DATETIME NULL COMMENT '最后一次修改时间，任何一个字段的修改都需更新这个字段',
  `is_posted` INT NULL COMMENT '是否群发发布，0代表还未群发，1代表已经群发',
  `is_previewd` INT NULL COMMENT '是否预览过，1代表已经预览，0代表未预览',
  `media_id` INT NULL COMMENT '调用微信接口获取',
  `media_created_time` DATETIME NULL COMMENT 'media创建时间，每个图文消息都对应一个mediaId，这个id通过调用微信接口获取。',
  `posted_time` DATETIME NULL COMMENT '消息实际群发的时间，如果消息只是保存而没有发布，此字段为空',
  `msg_posted_id` INT NULL COMMENT '图文消息发布id，对应的是调用微信接口返回内容的msg_id字段（msg_id容易混淆，所以字段名取为msg_posted_id，代表是已经发布的消息，并且这个消息有一个唯一标示id）',
  `msg_data_id` INT NULL COMMENT '消息的数据ID，该字段只有在群发图文消息时，才会出现。可以用于在图文分析数据接口中，获取到对应的图文消息的数据，是图文分析数据接口中的msgid字段中的前半部分，详见图文分析数据接口中的msgid字段的介绍。',
  PRIMARY KEY (`id`)  COMMENT '主键',
  INDEX `in_add_time` (`add_time` ASC) ,
  INDEX `in_thumb_media_id` (`thumb_media_id` ASC) ,
  INDEX `in_last_update_time` (`last_update_time` ASC) ,
  INDEX `in_media_id` (`media_id` ASC) ,
  INDEX `in_media_create_time` (`media_created_time` ASC) ,
  INDEX `in_posted_time` (`posted_time` ASC) ,
  INDEX `in_msg_posted_id` (`msg_posted_id` ASC) ,
  INDEX `in_msg_data_id` (`msg_data_id` ASC) ;

CREATE TABLE `wechat`.`wx_mass_msg_item` (
  `id` INT NOT NULL AUTO_INCREMENT COMMENT '主键，唯一标示',
  `mass_msg_id` INT NULL COMMENT '关联wx_mass_msg表的id',
  `thumb_media_id` VARCHAR(255) NULL COMMENT '缩略图media_id',
  `author` VARCHAR(45) NULL COMMENT '作者，选填',
  `title` VARCHAR(100) NULL COMMENT '标题',
  `content` BLOB NULL COMMENT '内容',
  `content_source_url` VARCHAR(255) NULL COMMENT '阅读全文对应的链接',
  `show_cover_pic` INT NULL COMMENT '是否展示首页图片，1为展示，0为不展示',
  `cover_pic_url` VARCHAR(255) NULL COMMENT '封面图链接，通过调用微信接口获取',
  `add_time` DATETIME NULL COMMENT '此条item添加的时间',
  `last_update_time` DATETIME NULL COMMENT '最后一次修改此条item的时间',
  PRIMARY KEY (`id`)  COMMENT '',
  INDEX `in_mass_msg_id` (`mass_msg_id` ASC)  COMMENT '',
  INDEX `in_thumb_media_id` (`thumb_media_id` ASC)  COMMENT '',
  INDEX `in_add_time` (`add_time` ASC)  COMMENT '',
  INDEX `in_last_update_time` (`last_update_time` ASC)  COMMENT '');
